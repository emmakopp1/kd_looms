# Structure of the repository

This repository contains the following files:
```
code.Rproj
data/
├── images/
├── kd-lgs/
│   ├── kd-lgs_bcov/
│   ├── kd-lgs_bcov_byconcept/
│   ├── kd-lgs_datapoints.csv
│   └── kd-lgs_lx.csv
├── kd-looms/
├── Kra-DaiLooms28master-2.xlsx
└── kd_looms_matrix_levels.csv
output/
├── data/
├── figures/
├── tables/
└── trees/
src/
├── 00_Preprocess.R
├── 01_Transform.R
└── 02_Visualise.R
README.md
```
The repository `data`include `images` where we stock all the images found in the article.`kd-lgs` contains the data used to infer the language phylogeny with BEAST.  We used `kd-lgs-datapoints.csv`and `kd-lgs_lx.csv` to create `kd-lgs_bcov`and `kd-lgs_bcov_byconcept`.  The two last repository contains nexus, the xml, the trees and the log files. `kd-looms`contains all the model tested to infer looms phylogeny and the input data. The four numbers at the end of each repository represent the weighted attributed to level of looms. 

The repository `output` contains all the output files of this project. `data` gives summaries of both languages and looms inferences. `figures`are the plots generated by the code in `02_Visualise.R`. `tables`contains Latex tables for the script and `trees` the consensus trees from analysis. 

The repository `src` contains three files. `00_Preprocess.R` have to objective. It creates the nexus files from the csv files for language and looms data. In particular, for looms data, it weights the according to the differents choosen levels. It also check that traces and ESS outputs after the beast analysis are valids. `01_Transform.R` generates the consensus trees, ages of internal nodes (MRCA's) and mutation rates for analysis where we allow multiples evolution rates. The file `02_Visualize.R` generates the figures in `output`.

# Run the project 

1. **Preprocess Data**
   - Run `00_Preprocess.R` to create the nexus files for languages and looms data and check BEAST outputs parameters are valids.

2. **Transform Data**
   - Execute `01_Transform.R` to generate consensus trees, compute internal nodes depth and mutation rates when needed. 

3. **Visualise Data**
   - Run `02_Visualise.R` to generate visualizations from the transformed data.


# Dependencies
Ensure you have the following R packages installed:

- `here`
- `phangorn`
- `phytools`
- `TreeTools`
- `tracerer`
- `tidyverse`
- `HDInterval`
- `sf`
- `rnaturalearth`
- `ggspatial`
- `stringi`
- `ggtree`
- `ggthemes`
- `ggridges`
- `ggtext`
- `ggstar`
- `ggforce`
- `knitr`
- `kableExtra`
- `patchwork`

You can install these packages using the following command in R:

```R
install.packages(c(
    "phangorn",
    "phytools",
    "TreeTools",
    "tracerer",
    "tidyverse",
    "HDInterval",
    "sf",
    "rnaturalearth",
    "ggspatial",
    "stringi",
    "ggtree",
    "ggthemes",
    "ggridges",
    "ggtext",
    "ggstar",
    "ggforce",
    "knitr",
    "kableExtra",
    "patchwork"))
```













